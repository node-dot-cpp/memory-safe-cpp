diff --git a/CMakeLists.txt b/CMakeLists.txt
index b9a10685b99..2afaf043703 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -28,6 +28,51 @@ if(NOT DEFINED LLVM_VERSION_SUFFIX)
   set(LLVM_VERSION_SUFFIX "")
 endif()
 
+#mb: replace default /Zi, with /Z7 for sccache
+if(MSVC)
+  string(REGEX REPLACE "/Z[iI7]" ""
+         CMAKE_C_FLAGS_DEBUG
+         "${CMAKE_C_FLAGS_DEBUG}")
+  set(CMAKE_C_FLAGS_DEBUG "${CMAKE_C_FLAGS_DEBUG} /Z7")
+
+  string(REGEX REPLACE "/Z[iI7]" ""
+         CMAKE_C_FLAGS_RELEASE
+         "${CMAKE_C_FLAGS_RELEASE}")
+  set(CMAKE_C_FLAGS_RELEASE "${CMAKE_C_FLAGS_RELEASE} /Z7")
+
+  string(REGEX REPLACE "/Z[iI7]" ""
+         CMAKE_C_FLAGS_RELWITHDEBINFO
+         "${CMAKE_C_FLAGS_RELWITHDEBINFO}")
+  set(CMAKE_C_FLAGS_RELWITHDEBINFO "${CMAKE_C_FLAGS_RELWITHDEBINFO} /Z7")
+
+  string(REGEX REPLACE "/Z[iI7]" ""
+         CMAKE_C_FLAGS_MINSIZEREL
+         "${CMAKE_C_FLAGS_MINSIZEREL}")
+  set(CMAKE_C_FLAGS_MINSIZEREL "${CMAKE_C_FLAGS_MINSIZEREL} /Z7")
+
+  string(REGEX REPLACE "/Z[iI7]" ""
+         CMAKE_CXX_FLAGS_DEBUG
+         "${CMAKE_CXX_FLAGS_DEBUG}")
+  set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} /Z7")
+
+  string(REGEX REPLACE "/Z[iI7]" ""
+         CMAKE_CXX_FLAGS_RELEASE
+         "${CMAKE_CXX_FLAGS_RELEASE}")
+  set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} /Z7")
+
+  string(REGEX REPLACE "/Z[iI7]" ""
+         CMAKE_CXX_FLAGS_RELWITHDEBINFO
+         "${CMAKE_CXX_FLAGS_RELWITHDEBINFO}")
+  set(CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO} /Z7")
+
+  string(REGEX REPLACE "/Z[iI7]" ""
+         CMAKE_CXX_FLAGS_MINSIZEREL
+         "${CMAKE_CXX_FLAGS_MINSIZEREL}")
+  set(CMAKE_CXX_FLAGS_MINSIZEREL "${CMAKE_CXX_FLAGS_MINSIZEREL} /Z7")
+
+endif()
+
+
 if (NOT PACKAGE_VERSION)
   set(PACKAGE_VERSION
     "${LLVM_VERSION_MAJOR}.${LLVM_VERSION_MINOR}.${LLVM_VERSION_PATCH}${LLVM_VERSION_SUFFIX}")
